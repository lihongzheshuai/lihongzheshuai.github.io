---
layout: post
title: ä¸€èµ·å­¦Java(22)-[JDKç¯‡]å­¦ä¹ Javaä¸­Stringçš„å­—ç¬¦ç¼–ç å’Œä»£ç†å¯¹æœºåˆ¶
date: 2024-12-22 22:00 +0800
author: onecoder
comments: true
tags: [Java, JDK, ä¸€èµ·å­¦Java]
categories: [ä¸€èµ·å­¦Javaç³»åˆ—,ï¼ˆ3ï¼‰JDKç¯‡]
---
ä¸Šæ–‡[***ã€Šä¸€èµ·å­¦Java(21)-[é…ç½®ç¯‡]Gradleæ§åˆ¶å°ä¹±ç é—®é¢˜é…ç½®å’Œè§£å†³ã€‹***](https://www.coderli.com/java-go-21-gradle-idea-console-garbled/)ä¸­ï¼Œæˆ‘ä»¬è§£å†³äº†Gradleæ§åˆ¶å°å­—ç¬¦ä¹±ç é—®é¢˜ï¼Œè¿™ä¸ªé—®é¢˜å®é™…æ˜¯åœ¨ç ”ç©¶Java Stringçš„å­—ç¬¦ç¼–ç æœºåˆ¶æ—¶äº§ç”Ÿçš„ã€‚æœ¬æ–‡å›å½’æ­£é¢˜ï¼Œç ”ç©¶ä¸‹Javaä¸­Stringçš„å­—ç¬¦ç¼–ç å’Œä»£ç†å¯¹æœºåˆ¶ã€‚

<!--more-->

## Java ä¸­ `String` çš„å­—ç¬¦ç¼–ç ä¸ä»£ç†å¯¹æœºåˆ¶

### **ï¼ˆä¸€ï¼‰èƒŒæ™¯ï¼šUnicodeå’ŒUTF-16**

åœ¨ç†è§£ä»£ç†å¯¹ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆäº†è§£ `Unicode` å’Œ `UTF-16`ã€‚

- **Unicode**ï¼š`Unicode` æ˜¯ä¸€ä¸ªå­—ç¬¦é›†ï¼Œå®ƒä¸ºä¸–ç•Œä¸Šå‡ ä¹æ‰€æœ‰çš„å­—ç¬¦éƒ½åˆ†é…äº†ä¸€ä¸ªå”¯ä¸€çš„æ•°å­—ç¼–å·ï¼Œè¿™ä¸ªç¼–å·è¢«ç§°ä¸º **ç ç‚¹ï¼ˆCode Pointï¼‰**ã€‚`Unicode` çš„ç ç‚¹èŒƒå›´æ˜¯ä» `U+0000` åˆ° `U+10FFFF`ï¼Œæ€»å…±æœ‰ 1,114,112 ä¸ªç ä½ã€‚
- **UTF-16**ï¼š`UTF-16` æ˜¯ä¸€ç§ `Unicode` çš„ **ç¼–ç æ–¹å¼**ã€‚å®ƒä½¿ç”¨ 16 ä½ï¼ˆ2 å­—èŠ‚ï¼‰æˆ– 32 ä½ï¼ˆ4 å­—èŠ‚ï¼‰æ¥è¡¨ç¤ºä¸€ä¸ª `Unicode` å­—ç¬¦ã€‚

#### **1. åŸºæœ¬å¤šæ–‡ç§å¹³é¢ï¼ˆBMPï¼‰å’Œè¡¥å……å­—ç¬¦**

`Unicode` å°†æ‰€æœ‰å­—ç¬¦åˆ†ä¸ºäº† 17 ä¸ªå¹³é¢ï¼ˆPlaneï¼‰ï¼Œç¼–å·ä» 0 åˆ° 16ã€‚å…¶ä¸­ï¼Œç¬¬ 0 å·å¹³é¢è¢«ç§°ä¸º **åŸºæœ¬å¤šæ–‡ç§å¹³é¢ï¼ˆBasic Multilingual Planeï¼ŒBMPï¼‰**ï¼Œå…¶ç ç‚¹èŒƒå›´æ˜¯ `U+0000` åˆ° `U+FFFF`ã€‚`BMP` åŒ…å«äº†æœ€å¸¸ç”¨çš„å­—ç¬¦ï¼Œä¾‹å¦‚ `ASCII` å­—ç¬¦ã€æ‹‰ä¸å­—æ¯ã€æ±‰å­—ç­‰ã€‚

è¶…å‡º `BMP` çš„å­—ç¬¦è¢«ç§°ä¸º **è¡¥å……å­—ç¬¦ï¼ˆSupplementary Charactersï¼‰**ï¼Œå®ƒä»¬çš„ç ç‚¹èŒƒå›´æ˜¯ `U+010000` åˆ° `U+10FFFF`ã€‚è¿™äº›å­—ç¬¦åŒ…æ‹¬ä¸€äº›ä¸å¸¸ç”¨çš„æ±‰å­—ã€å¤ä»£æ–‡å­—ã€è¡¨æƒ…ç¬¦å·ç­‰ã€‚

#### **2. ä»£ç†å¯¹ï¼ˆSurrogate Pairï¼‰**

ç”±äº `UTF-16` ä½¿ç”¨ 16 ä½æ¥è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦ï¼Œå› æ­¤ `BMP` ä¸­çš„å­—ç¬¦å¯ä»¥ç›´æ¥ç”¨ä¸€ä¸ª 16 ä½çš„ç å…ƒæ¥è¡¨ç¤ºã€‚ä½†æ˜¯ï¼Œå¯¹äºè¡¥å……å­—ç¬¦ï¼Œç”±äºå…¶ç ç‚¹è¶…è¿‡äº† 16 ä½çš„è¡¨ç¤ºèŒƒå›´ï¼Œ`UTF-16` éœ€è¦ä½¿ç”¨ **ä¸€å¯¹ 16 ä½çš„ç å…ƒ** æ¥è¡¨ç¤ºï¼Œè¿™å¯¹ç å…ƒå°±ç§°ä¸º **ä»£ç†å¯¹ï¼ˆSurrogate Pairï¼‰**ã€‚

ä»£ç†å¯¹ç”±ä¸¤ä¸ªéƒ¨åˆ†ç»„æˆï¼š

- **é«˜ä½ä»£ç†ï¼ˆHigh Surrogateï¼‰**ï¼šèŒƒå›´æ˜¯ `U+D800` åˆ° `U+DBFF`ã€‚
- **ä½ä½ä»£ç†ï¼ˆLow Surrogateï¼‰**ï¼šèŒƒå›´æ˜¯ `U+DC00` åˆ° `U+DFFF`ã€‚

#### **3. ä»£ç†å¯¹çš„ç¼–ç æ–¹å¼**

è¦å°†ä¸€ä¸ªè¡¥å……å­—ç¬¦çš„ç ç‚¹è½¬æ¢ä¸ºä»£ç†å¯¹ï¼Œéœ€è¦è¿›è¡Œä»¥ä¸‹æ­¥éª¤ï¼š

1. å°†ç ç‚¹å‡å» `0x10000`ã€‚
2. å°†ç»“æœçš„é«˜ 10 ä½åŠ  `0xD800`ï¼Œå¾—åˆ°é«˜ä½ä»£ç†ã€‚
3. å°†ç»“æœçš„ä½ 10 ä½åŠ  `0xDC00`ï¼Œå¾—åˆ°ä½ä½ä»£ç†ã€‚

ä¾‹å¦‚ï¼Œå­—ç¬¦ `U+1F600`ï¼ˆç¬‘è„¸è¡¨æƒ…ğŸ˜€ï¼‰çš„è½¬æ¢è¿‡ç¨‹å¦‚ä¸‹ï¼š

1. `0x1F600 - 0x10000 = 0xF600`
2. é«˜ 10 ä½ï¼š`0xF`ï¼ŒåŠ  `0xD800` å¾—åˆ° `0xD80F`
3. ä½ 10 ä½ï¼š`0x600`ï¼ŒåŠ  `0xDC00` å¾—åˆ° `0xDE00`

å› æ­¤ï¼Œ`U+1F600` çš„ `UTF-16` ç¼–ç ä¸º **`0xD80F 0xDE00`**ã€‚

#### 4. **ä¸ºä»€ä¹ˆéœ€è¦ä»£ç†å¯¹ï¼Ÿ**

- **Unicode æ‰©å±•**ï¼šä»£ç†å¯¹æœºåˆ¶ä½¿å¾— UTF-16 ç¼–ç å¯ä»¥è¡¨ç¤ºè¶…è¿‡åŸºæœ¬å¤šè¯­è¨€å¹³é¢ï¼ˆBMPï¼‰èŒƒå›´çš„å­—ç¬¦ï¼Œå³ Unicode ä¸­çš„æ‰€æœ‰å­—ç¬¦ã€‚UTF-16 æœ¬èº«æ˜¯ä¸€ä¸ª 16 ä½ç¼–ç ï¼Œä½†ä¸ºäº†æ‰©å±•å­—ç¬¦çš„è¡¨ç¤ºèŒƒå›´ï¼Œå®ƒå¼•å…¥äº†ä»£ç†å¯¹çš„æ¦‚å¿µã€‚
  
- **æ”¯æŒå¤šè¯­è¨€ä¸ç¬¦å·**ï¼šUnicode è¦†ç›–äº†å…¨çƒå‡ ä¹æ‰€æœ‰çš„è¯­è¨€å­—ç¬¦å’Œç¬¦å·ï¼ˆåŒ…æ‹¬è¡¨æƒ…ç¬¦å·ã€æ•°å­¦ç¬¦å·ç­‰ï¼‰ï¼Œä¸ºäº†æ”¯æŒè¿™äº›ç¬¦å·çš„è¡¨ç¤ºï¼ŒUTF-16 ä½¿ç”¨äº†ä»£ç†å¯¹æŠ€æœ¯ã€‚

- **å‘åå…¼å®¹**ï¼šä»£ç†å¯¹æœºåˆ¶ä¸ä¼šç ´å UTF-16 ç¼–ç çš„å‘åå…¼å®¹æ€§ï¼ŒåŸæœ¬ä½¿ç”¨ 2 å­—èŠ‚è¡¨ç¤ºçš„ BMP å­—ç¬¦ä¸éœ€è¦æ”¹å˜ï¼ŒåŒæ—¶å¯¹äºè¶…å‡º BMP çš„å­—ç¬¦å¼•å…¥äº† 4 å­—èŠ‚è¡¨ç¤ºã€‚

### **ï¼ˆäºŒï¼‰Java ä¸­ `String` çš„å­—ç¬¦ç¼–ç **

#### **1. ä»£ç†å¯¹å­—ç¬¦å¦‚ä½•å­˜å‚¨**

åœ¨ Java ä¸­ï¼Œ`String` ç±»ä½¿ç”¨ `UTF-16` ç¼–ç æ¥å­˜å‚¨å­—ç¬¦ä¸²ã€‚è¿™æ˜¯å› ä¸º Java è¯­è¨€è®¾è®¡ä¹‹åˆï¼Œäººä»¬è®¤ä¸º 16 ä½è¶³ä»¥è¡¨ç¤ºæ‰€æœ‰å¯èƒ½çš„å­—ç¬¦ã€‚ç„¶è€Œï¼Œè¿™æ˜¯ä¸€ä¸ªä¸æ­£ç¡®çš„åˆ¤æ–­ã€‚åæ¥ `Unicode` è§„èŒƒæ‰©å±•åˆ°äº†è¶…è¿‡16 ä½ï¼Œæ‰€ä»¥ Java ä¸­çš„å­—ç¬¦ç°åœ¨å¯èƒ½ç”±ä¸€å¯¹ 16 ä½çš„å€¼ï¼ˆç§°ä¸ºâ€œä»£ç†å¯¹â€ï¼‰è¡¨ç¤ºã€‚è¿™æ„å‘³ç€ï¼š

- `BMP` ä¸­çš„å­—ç¬¦å ç”¨ä¸€ä¸ª `char`ï¼ˆ16 ä½ï¼‰ã€‚
- è¡¥å……å­—ç¬¦å ç”¨ä¸¤ä¸ª `char`ï¼Œå³ä¸€ä¸ªä»£ç†å¯¹ã€‚

ä¾‹å¦‚ï¼š

```java
String str = "Hello";
```

åœ¨å†…å­˜ä¸­ï¼Œ`str` ä¼šè¢«è¡¨ç¤ºä¸ºä¸€ä¸ª `String` å¯¹è±¡ï¼Œå®ƒå†…éƒ¨æŒæœ‰ä¸€ä¸ª `char[]` æ•°ç»„ï¼Œå†…å®¹æ˜¯ï¼š

```console
{'H', 'e', 'l', 'l', 'o'}
```

è¿™äº›å­—ç¬¦ï¼ˆ'H', 'e', 'l', 'l', 'o'ï¼‰åœ¨ UTF-16 ç¼–ç ä¸­æ˜¯ 2 å­—èŠ‚çš„ï¼Œå³æ¯ä¸ªå­—ç¬¦å ç”¨ 16 ä½ã€‚

>åœ¨Java 9ä¹‹å‰ï¼ŒStringå†…éƒ¨ä½¿ç”¨char[]æ•°ç»„æ¥å­˜å‚¨å­—ç¬¦ã€‚ä»Java 9å¼€å§‹ï¼Œä¸ºäº†èŠ‚çœç©ºé—´ï¼Œå¦‚æœå­—ç¬¦ä¸²åªåŒ…å«Latin-1å­—ç¬¦ï¼ˆå³ASCIIå­—ç¬¦çš„æ‰©å±•ï¼‰ï¼Œåˆ™ä½¿ç”¨byte[]æ•°ç»„å­˜å‚¨ï¼Œå¹¶ä½¿ç”¨ä¸€ä¸ªencoding-flagæ¥æ ‡è¯†ç¼–ç æ–¹å¼ã€‚
{: .prompt-info }

å†ä¾‹å¦‚ï¼Œä¸Šæ–‡æåˆ°å­—ç¬¦ `U+1F600`ï¼ˆç¬‘è„¸è¡¨æƒ…ğŸ˜€ï¼‰ï¼Œæ— æ³•ç”¨ä¸¤å­—èŠ‚è¡¨ç¤ºï¼Œéœ€è¦ç”¨ä»£ç†å¯¹è¡¨ç¤ºï¼Œå…¶ `UTF-16` ç¼–ç ä¸º **`0xD80F 0xDE00`**ã€‚åœ¨Javaç¨‹åºä¸­ï¼Œä¼šæœ‰ä»¥ä¸‹æƒ…å†µå‡ºç°ï¼šå½“åˆ¤æ–­å­—ç¬¦ä¸²é•¿åº¦æ—¶ï¼Œ`str.length()` æ–¹æ³•å°†è¿”å› å€¼ä¼šæ¯”ä½ çœ‹åˆ°çš„å­—ç¬¦å¤šï¼Œå› ä¸ºä»£ç†å¯¹è¢«è®¡ä¸ºä¸¤ä¸ªå­—ç¬¦ã€‚

```java
package com.coderli.one.jdk.common;

public class StringCodeDemo {
    public static void main(String[] args) {
        String str = "HelloğŸ˜€";

        // è·å–å­—ç¬¦ä¸²é•¿åº¦
        System.out.println("å­—ç¬¦ä¸²çš„é•¿åº¦ï¼ˆå­—ç¬¦æ•°ï¼‰ï¼š" + str.length()); // 7

        // ä½¿ç”¨ codePointAt æ¥å¤„ç†å®Œæ•´å­—ç¬¦
        System.out.println("å­—ç¬¦ 'ğŸ˜€' çš„ Unicode ç ç‚¹ï¼š" + Integer.toHexString(str.codePointAt(5)).toUpperCase());
        System.out.println("å­—ç¬¦ 'ğŸ˜€' çš„ Unicode ç ç‚¹ï¼š" + str.codePointAt(5)); // 128512 (U+1F600)

        // éå†å­—ç¬¦ä¸²ä¸­çš„æ¯ä¸ªå­—ç¬¦ï¼ˆæ³¨æ„ä»£ç†å¯¹ä¼šè¢«åˆ†å¼€ï¼‰
        for (int i = 0; i < str.length(); i++) {
            char c = str.charAt(i);
            System.out.println("å­—ç¬¦ " + c + " çš„ç¼–ç æ˜¯ï¼š" + (int)c);
        }

        // ä½¿ç”¨ codePointAt è·å–å®Œæ•´çš„Unicodeç ç‚¹
        for (int i = 0; i < str.length(); ) {
            int codePoint = str.codePointAt(i);
            System.out.println("Unicode ç ç‚¹: " + codePoint); // ä¼šæ˜¾ç¤º U+1F600
            i += Character.charCount(codePoint); // å¤„ç†ä»£ç†å¯¹
        }
    }
}
```

è¾“å‡ºä¸º

```console
å­—ç¬¦ä¸²çš„é•¿åº¦ï¼ˆå­—ç¬¦æ•°ï¼‰ï¼š7
å­—ç¬¦ 'ğŸ˜€' çš„ Unicode ç ç‚¹ï¼š1F600
å­—ç¬¦ 'ğŸ˜€' çš„ Unicode ç ç‚¹ï¼š128512
å­—ç¬¦ H çš„ç¼–ç æ˜¯ï¼š72
å­—ç¬¦ e çš„ç¼–ç æ˜¯ï¼š101
å­—ç¬¦ l çš„ç¼–ç æ˜¯ï¼š108
å­—ç¬¦ l çš„ç¼–ç æ˜¯ï¼š108
å­—ç¬¦ o çš„ç¼–ç æ˜¯ï¼š111
å­—ç¬¦ ? çš„ç¼–ç æ˜¯ï¼š55357
å­—ç¬¦ ? çš„ç¼–ç æ˜¯ï¼š56832
Unicode ç ç‚¹: 72
Unicode ç ç‚¹: 101
Unicode ç ç‚¹: 108
Unicode ç ç‚¹: 108
Unicode ç ç‚¹: 111
Unicode ç ç‚¹: 128512
```

#### **2. ä»£ç†å¯¹å­—ç¬¦å¦‚ä½•è¯†åˆ«**

åœ¨ Java ä¸­ï¼Œç¨‹åºå¦‚ä½•çŸ¥é“å“ªäº›å­—ç¬¦æ˜¯ä»£ç†å¯¹ï¼ˆ**surrogate pairs**ï¼‰ï¼Œå“ªäº›ä¸æ˜¯ï¼Œä¸»è¦ä¾èµ–äº **Unicode ç¼–ç èŒƒå›´** å’Œ **UTF-16 ç¼–ç çš„è§„èŒƒ**ã€‚

åœ¨ UTF-16 ä¸­ï¼Œæ¯ä¸ªå­—ç¬¦çš„å­˜å‚¨å•å…ƒï¼ˆ`char` ç±»å‹ï¼‰æ˜¯ 16 ä½çš„ï¼Œå› æ­¤å®ƒçš„å€¼èŒƒå›´ä» `0x0000` åˆ° `0xFFFF`ã€‚ç„¶è€Œï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰åœ¨è¿™ä¸ªèŒƒå›´å†…çš„å­—ç¬¦éƒ½æ˜¯æœ‰æ•ˆçš„å­—ç¬¦ã€‚UTF-16 å°†è¿™ä¸ª 16 ä½çš„èŒƒå›´åˆ’åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼š

- **é«˜ä½ä»£ç†**ï¼šè¿™äº›å­—ç¬¦çš„ Unicode å€¼ä½äº `0xD800` åˆ° `0xDBFF` ä¹‹é—´ã€‚è¿™äº›å­—ç¬¦å¹¶ä¸è¡¨ç¤ºæœ‰æ•ˆçš„ Unicode å­—ç¬¦ï¼Œè€Œæ˜¯ä½œä¸ºä»£ç†å¯¹çš„ä¸€éƒ¨åˆ†ï¼Œç”¨äºè¡¨ç¤º Unicode æ‰©å±•å­—ç¬¦ã€‚
  
- **ä½ä½ä»£ç†**ï¼šè¿™äº›å­—ç¬¦çš„ Unicode å€¼ä½äº `0xDC00` åˆ° `0xDFFF` ä¹‹é—´ï¼ŒåŒæ ·ä¸è¡¨ç¤ºæœ‰æ•ˆå­—ç¬¦ï¼Œè€Œæ˜¯ä½œä¸ºä»£ç†å¯¹çš„å¦ä¸€éƒ¨åˆ†ï¼Œä¸é«˜ä½ä»£ç†ä¸€èµ·è¡¨ç¤ºä¸€ä¸ªå®Œæ•´çš„å­—ç¬¦ã€‚

ä»»ä½• `char` å€¼ä½äºè¿™ä¸¤ä¸ªèŒƒå›´å†…çš„å­—ç¬¦ï¼Œéƒ½è¢«è§†ä¸º **ä»£ç†å¯¹çš„ä¸€éƒ¨åˆ†**ã€‚å¦‚æœä¸€ä¸ªå­—ç¬¦çš„å€¼åœ¨è¿™äº›èŒƒå›´ä¹‹å¤–ï¼ˆå³å¤§äº `0xDFFF` æˆ–å°äº `0xD800`ï¼‰ï¼Œåˆ™å®ƒæ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„ Unicode å­—ç¬¦ï¼Œä¸å±äºä»£ç†å¯¹ã€‚

ä¾‹å¦‚ï¼Œåœ¨ Java ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä»£ç æ¥åˆ¤æ–­ä¸€ä¸ªå­—ç¬¦æ˜¯å¦æ˜¯é«˜ä½ä»£ç†æˆ–ä½ä½ä»£ç†ï¼š

```java
package com.coderli.one.jdk.common;

public class SurrogateCheckerDemo {
    public static boolean isHighSurrogate(char ch) {
        return ch >= 0xD800 && ch <= 0xDBFF; // é«˜ä½ä»£ç†çš„èŒƒå›´
    }

    public static boolean isLowSurrogate(char ch) {
        return ch >= 0xDC00 && ch <= 0xDFFF; // ä½ä½ä»£ç†çš„èŒƒå›´
    }

    public static void main(String[] args) {
        char highSurrogate = 0xD83D; // è¡¨æƒ…ç¬¦å·çš„é«˜ä½ä»£ç†
        char lowSurrogate = 0xDE00;  // è¡¨æƒ…ç¬¦å·çš„ä½ä½ä»£ç†
        char normalChar = 'A';       // æ™®é€šå­—ç¬¦
        
        System.out.println("High Surrogate: " + isHighSurrogate(highSurrogate));  // true
        System.out.println("Low Surrogate: " + isLowSurrogate(lowSurrogate));    // true
        System.out.println("Normal Char: " + isHighSurrogate(normalChar));       // false
    }
}
```

è¾“å‡º

```console
High Surrogate: true
Low Surrogate: true
Normal Char: false
```

#### **3. å¦‚ä½•è¿˜åŸä»£ç†å¯¹**

ä¸ºäº†ä»ä»£ç†å¯¹ä¸­æ¢å¤å‡ºå®Œæ•´çš„ Unicode å­—ç¬¦ï¼Œç¨‹åºéœ€è¦å°†é«˜ä½ä»£ç†å’Œä½ä½ä»£ç†ç»„åˆåœ¨ä¸€èµ·ã€‚è¿˜åŸè¿‡ç¨‹çš„æ­¥éª¤å¦‚ä¸‹ï¼š

1. **ä»é«˜ä½ä»£ç†å’Œä½ä½ä»£ç†æ¢å¤åŸå§‹ Unicode å€¼**ï¼š
   - ç»™å®šé«˜ä½ä»£ç† `high` å’Œä½ä½ä»£ç† `low`ï¼ŒåŸå§‹ Unicode å­—ç¬¦çš„å€¼å¯ä»¥é€šè¿‡ä»¥ä¸‹å…¬å¼è®¡ç®—ï¼š
   \[
   Unicode = 0x10000 + ((high - 0xD800) << 10) + (low - 0xDC00)
   \]

   è¿™ä¸ªå…¬å¼é¦–å…ˆå°† `0x10000` åŠ ä¸Šé«˜ä½å’Œä½ä½ä»£ç†ä¸­çš„ 10 ä½æ•°æ®ï¼Œå…¶ä¸­ï¼š
   - `(high - 0xD800)` å–é«˜ä½ä»£ç†çš„åç§»é‡ï¼ˆä» 0 åˆ° 0x3FFï¼‰ã€‚
   - `(low - 0xDC00)` å–ä½ä½ä»£ç†çš„åç§»é‡ï¼ˆä» 0 åˆ° 0x3FFï¼‰ã€‚
   - é€šè¿‡å·¦ç§» 10 ä½å°†é«˜ä½å’Œä½ä½æ‹¼æ¥èµ·æ¥ï¼Œå¾—åˆ°å®Œæ•´çš„ 20 ä½ Unicode ç¼–ç ã€‚

2. **å°† Unicode å€¼è½¬æ¢ä¸ºå­—ç¬¦**ï¼šå¯ä»¥å°†è¿™ä¸ª 20 ä½çš„ Unicode å€¼æ˜ å°„å›æ ‡å‡†çš„å­—ç¬¦ã€‚

å‡è®¾æˆ‘ä»¬æœ‰ä¸¤ä¸ª `char`ï¼Œåˆ†åˆ«æ˜¯é«˜ä½ä»£ç†å’Œä½ä½ä»£ç†ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„ä»£ç æ¥æ¢å¤åŸå§‹çš„ Unicode å­—ç¬¦ã€‚

```java
package com.coderli.one.jdk.common;

public class SurrogatePairDecoderDemo {

    // å°†ä»£ç†å¯¹è¿˜åŸä¸ºåŸå§‹ Unicode å­—ç¬¦
    public static char[] decodeSurrogatePair(char high, char low) {
        // æ£€æŸ¥æ˜¯å¦ä¸ºä»£ç†å¯¹
        if (!isHighSurrogate(high) || !isLowSurrogate(low)) {
            throw new IllegalArgumentException("Invalid surrogate pair.");
        }

        // æ ¹æ®å…¬å¼è®¡ç®— Unicode å­—ç¬¦
        int unicodeValue = 0x10000 + ((high - 0xD800) << 10) + (low - 0xDC00);
        char[] decodedChars = Character.toChars(unicodeValue);  // è½¬æ¢æˆå­—ç¬¦
        return decodedChars;
    }

    // åˆ¤æ–­é«˜ä½ä»£ç†
    public static boolean isHighSurrogate(char ch) {
        return ch >= 0xD800 && ch <= 0xDBFF;
    }

    // åˆ¤æ–­ä½ä½ä»£ç†
    public static boolean isLowSurrogate(char ch) {
        return ch >= 0xDC00 && ch <= 0xDFFF;
    }

    public static void main(String[] args) {
        char highSurrogate = 0xD83D; // è¡¨æƒ…ç¬¦å·çš„é«˜ä½ä»£ç†
        char lowSurrogate = 0xDE00;  // è¡¨æƒ…ç¬¦å·çš„ä½ä½ä»£ç†
        
        char[] result = decodeSurrogatePair(highSurrogate, lowSurrogate);
        System.out.println("Decoded Character: " + new String(result));  // è¾“å‡º "ğŸ˜Š"
    }
}
```

è¾“å‡º

```console
Decoded Character: ğŸ˜€
```

### **ï¼ˆä¸‰ï¼‰æ€»ç»“**

- **UTF-16 ç¼–ç **ï¼šJava ä¸­çš„ `String` ä½¿ç”¨ UTF-16 ç¼–ç è¡¨ç¤ºå­—ç¬¦ã€‚UTF-16 ä½¿ç”¨ 2 å­—èŠ‚è¡¨ç¤ºå¤§éƒ¨åˆ†å¸¸ç”¨å­—ç¬¦ï¼Œè€Œå¯¹ä¸åœ¨åŸºæœ¬å¤šè¯­è¨€å¹³é¢ï¼ˆBMPï¼‰å†…çš„å­—ç¬¦ï¼ŒUTF-16 ä½¿ç”¨ **ä»£ç†å¯¹**ï¼ˆsurrogate pairï¼‰è¡¨ç¤ºï¼Œè¿™ä¸¤ä¸ª `char` å•å…ƒå…±åŒç»„æˆä¸€ä¸ªå­—ç¬¦ã€‚
- **ä»£ç†å¯¹æœºåˆ¶**ï¼šä»£ç†å¯¹ç”± **é«˜ä½ä»£ç†** å’Œ **ä½ä½ä»£ç†** ä¸¤ä¸ª `char` ç»„æˆï¼Œç”¨äºè¡¨ç¤ºé‚£äº›è¶…å‡º BMP èŒƒå›´çš„å­—ç¬¦ã€‚è¿™æ ·ï¼ŒUTF-16 èƒ½å¤Ÿè¡¨ç¤º Unicode ä¸­çš„æ‰€æœ‰å­—ç¬¦ã€‚

Java çš„ `String` ç±»é€šè¿‡ UTF-16 ç¼–ç å’Œä»£ç†å¯¹æœºåˆ¶ï¼Œå®ç°äº†å¯¹å¹¿æ³›å­—ç¬¦é›†çš„æ”¯æŒï¼Œæ—¢èƒ½é«˜æ•ˆå¤„ç†å¸¸ç”¨å­—ç¬¦ï¼Œåˆèƒ½è¡¨ç¤ºæ‰©å±•å­—ç¬¦å¦‚è¡¨æƒ…ç¬¦å·ç­‰ã€‚

---

æ‰€æœ‰ä»£ç å·²ä¸Šä¼ è‡³ï¼š[***https://github.com/lihongzheshuai/java-all-in-one***](https://github.com/lihongzheshuai/java-all-in-one)
